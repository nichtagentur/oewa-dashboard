<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OEWA Dashboard</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Fraunces:wght@600;700&display=swap');

    :root {
      --bg-1: #f7f1e8;
      --bg-2: #e6f2ef;
      --ink: #1b1b1f;
      --muted: #5c5c66;
      --accent: #0f766e;
      --accent-2: #0c4a6e;
      --card: #ffffff;
      --stroke: #e6e2d9;
      --warn: #c2410c;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Space Grotesk", system-ui, -apple-system, Segoe UI, sans-serif;
      color: var(--ink);
      background: radial-gradient(1200px 600px at 10% -10%, #e1f1ff 0%, transparent 60%),
                  radial-gradient(900px 500px at 110% 10%, #ffe9c9 0%, transparent 55%),
                  linear-gradient(180deg, var(--bg-1), var(--bg-2));
      min-height: 100vh;
      animation: fadeIn 0.8s ease;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 28px 20px 60px;
    }

    header {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-bottom: 24px;
      animation: slideDown 0.8s ease;
    }

    h1 {
      font-family: "Fraunces", serif;
      font-size: 34px;
      margin: 0;
    }

    .subtitle {
      color: var(--muted);
      font-size: 15px;
    }

    .kpis {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin: 20px 0 28px;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: 14px;
      padding: 16px 18px;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.08);
      transform: translateY(12px);
      opacity: 0;
      animation: riseIn 0.8s ease forwards;
    }

    .card:nth-of-type(1) { animation-delay: 0.05s; }
    .card:nth-of-type(2) { animation-delay: 0.10s; }
    .card:nth-of-type(3) { animation-delay: 0.15s; }
    .card:nth-of-type(4) { animation-delay: 0.20s; }
    .card:nth-of-type(5) { animation-delay: 0.25s; }
    .card:nth-of-type(6) { animation-delay: 0.30s; }

    .kpi-label {
      color: var(--muted);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .kpi-value {
      font-size: 26px;
      font-weight: 700;
      margin-top: 6px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 16px;
    }

    .section-title {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 8px;
    }

    .chart {
      width: 100%;
      height: 260px;
    }

    .chart .draw {
      stroke-dasharray: 1200;
      stroke-dashoffset: 1200;
      animation: drawLine 1.4s ease forwards;
    }

    .chart .pop {
      transform-origin: center;
      animation: popIn 0.6s ease forwards;
    }

    .chart .bar {
      transform-origin: bottom;
      animation: growBar 0.8s ease forwards;
    }

    .chart circle,
    .chart rect {
      transition: transform 0.15s ease, opacity 0.15s ease;
    }

    .chart circle:hover,
    .chart rect:hover {
      transform: scale(1.15);
      opacity: 1;
    }

    .list li {
      animation: fadeIn 0.6s ease forwards;
    }

    .list li:nth-child(1) { animation-delay: 0.10s; }
    .list li:nth-child(2) { animation-delay: 0.14s; }
    .list li:nth-child(3) { animation-delay: 0.18s; }
    .list li:nth-child(4) { animation-delay: 0.22s; }
    .list li:nth-child(5) { animation-delay: 0.26s; }
    .list li:nth-child(6) { animation-delay: 0.30s; }
    .list li:nth-child(7) { animation-delay: 0.34s; }
    .list li:nth-child(8) { animation-delay: 0.38s; }
    .list li:nth-child(9) { animation-delay: 0.42s; }
    .list li:nth-child(10) { animation-delay: 0.46s; }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes riseIn {
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes drawLine {
      to { stroke-dashoffset: 0; }
    }

    @keyframes popIn {
      from { transform: scale(0.6); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    @keyframes growBar {
      from { transform: scaleY(0.2); opacity: 0; }
      to { transform: scaleY(1); opacity: 1; }
    }

    .list {
      margin: 0;
      padding: 0;
      list-style: none;
      display: grid;
      gap: 8px;
    }

    .list li {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      padding: 6px 0;
      border-bottom: 1px dashed var(--stroke);
      opacity: 0;
    }

    .toggle {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--stroke);
      background: #f8fafc;
      font-weight: 600;
      cursor: pointer;
    }

    .toggle::after {
      content: "▾";
      font-size: 14px;
      color: var(--muted);
    }

    .toggle[aria-expanded="true"]::after {
      transform: rotate(180deg);
    }

    .desc {
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height 0.3s ease, opacity 0.3s ease;
      margin-top: 0;
    }

    .desc.open {
      max-height: 600px;
      opacity: 1;
      margin-top: 12px;
    }

    .pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #3730a3;
      align-self: center;
    }

    .legend {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      font-size: 12px;
      color: var(--muted);
      margin-top: 8px;
    }

    .legend span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
    }

    .footer-note {
      margin-top: 28px;
      font-size: 12px;
      color: var(--muted);
    }

    .tooltip {
      position: fixed;
      pointer-events: none;
      background: #111827;
      color: #f9fafb;
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 8px;
      box-shadow: 0 8px 18px rgba(0,0,0,0.18);
      opacity: 0;
      transform: translate(-50%, -110%);
      transition: opacity 0.12s ease;
      z-index: 9999;
      white-space: nowrap;
    }

    @media (max-width: 640px) {
      h1 { font-size: 28px; }
      .chart { height: 220px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>OEWA Market Dashboard</h1>
      <div class="subtitle">This dataset tracks monthly usage quality for Austrian digital brands and networks measured by OEWA.</div>
    </header>

    <section class="card" style="margin-bottom: 18px;">
      <button class="toggle" id="desc-toggle" aria-expanded="false">Show data description</button>
      <div class="desc" id="desc-panel">
        <div class="section-title">What this data is</div>
        <div class="subtitle" style="margin-top: 6px;">
          OEWA (Austrian Web Analysis) publishes audience measurement for websites and digital networks.
          Each row is one brand (or network) in one month.
          The data covers November 2021 to December 2025.
        </div>
        <div class="subtitle" style="margin-top: 10px;">
          Key columns:
          <strong>visits</strong> = number of visits,
          <strong>impressions</strong> = page views,
          <strong>usetime_seconds</strong> = average time spent,
          <strong>impressions_per_visits</strong> = pages per visit,
          <strong>net_reach</strong> = reach in percent.
        </div>
        <div class="subtitle" style="margin-top: 10px;">
          Categories:
          <strong>einzelangebot</strong> = single website,
          <strong>dach-marken</strong> = brand umbrella / media house,
          <strong>adnetwork</strong> = ad network group.
        </div>
      </div>
    </section>

    <section class="kpis" id="kpis"></section>

    <section class="grid">
      <div class="card">
        <div class="section-title">Total Impressions by Category</div>
        <div class="subtitle">Shows page views per category over time.</div>
        <svg class="chart" id="chart-category" viewBox="0 0 600 260"></svg>
        <div class="legend" id="legend-category"></div>
      </div>

      <div class="card">
        <div class="section-title">Top 10 Brands (Latest Month)</div>
        <div class="subtitle">Highest impressions (page views) in the latest month.</div>
        <ol class="list" id="top-list"></ol>
      </div>

      <div class="card">
        <div class="section-title">Engagement Quality (Top 30)</div>
        <div class="subtitle">Bigger dots mean more users. Up and right means deeper engagement.</div>
        <svg class="chart" id="chart-scatter" viewBox="0 0 600 260"></svg>
        <div class="legend">X: Impressions per Visit, Y: Avg Time Spent (seconds)</div>
      </div>

      <div class="card">
        <div class="section-title">Missing Data Counts</div>
        <div class="subtitle">Months where OEWA did not provide data.</div>
        <svg class="chart" id="chart-missing" viewBox="0 0 600 260"></svg>
        <div class="legend" id="legend-missing"></div>
      </div>
    </section>

    <div class="footer-note">Data source: OEWA exports (2021-11 to 2025-12)</div>
  </div>

  <div class="tooltip" id="tooltip"></div>

  <script>
  const data = {
  "latest_month": "2025-12-01",
  "months": [
    "2021-11-01",
    "2021-12-01",
    "2022-01-01",
    "2022-02-01",
    "2022-03-01",
    "2022-04-01",
    "2022-05-01",
    "2022-06-01",
    "2022-07-01",
    "2022-08-01",
    "2022-09-01",
    "2022-10-01",
    "2022-11-01",
    "2022-12-01",
    "2023-01-01",
    "2023-02-01",
    "2023-03-01",
    "2023-04-01",
    "2023-05-01",
    "2023-06-01",
    "2023-07-01",
    "2023-08-01",
    "2023-09-01",
    "2023-10-01",
    "2023-11-01",
    "2023-12-01",
    "2024-01-01",
    "2024-02-01",
    "2024-03-01",
    "2024-04-01",
    "2024-05-01",
    "2024-06-01",
    "2024-07-01",
    "2024-08-01",
    "2024-09-01",
    "2024-10-01",
    "2024-11-01",
    "2024-12-01",
    "2025-01-01",
    "2025-02-01",
    "2025-03-01",
    "2025-04-01",
    "2025-05-01",
    "2025-06-01",
    "2025-07-01",
    "2025-08-01",
    "2025-09-01",
    "2025-10-01",
    "2025-11-01",
    "2025-12-01"
  ],
  "category_series": [
    {
      "category": "adnetwork",
      "series": [
        {
          "month": "2021-11-01",
          "value": 4155989740
        },
        {
          "month": "2021-12-01",
          "value": 4086005608
        },
        {
          "month": "2022-01-01",
          "value": 4607609660
        },
        {
          "month": "2022-02-01",
          "value": 3986592004
        },
        {
          "month": "2022-03-01",
          "value": 4270249431
        },
        {
          "month": "2022-04-01",
          "value": 4146389063
        },
        {
          "month": "2022-05-01",
          "value": 4048548522
        },
        {
          "month": "2022-06-01",
          "value": 3750494231
        },
        {
          "month": "2022-07-01",
          "value": 3805962265
        },
        {
          "month": "2022-08-01",
          "value": 4015802899
        },
        {
          "month": "2022-09-01",
          "value": 4149051817
        },
        {
          "month": "2022-10-01",
          "value": 4230049694
        },
        {
          "month": "2022-11-01",
          "value": 3995822515
        },
        {
          "month": "2022-12-01",
          "value": 3495350025
        },
        {
          "month": "2023-01-01",
          "value": 4023688217
        },
        {
          "month": "2023-02-01",
          "value": 3639555579
        },
        {
          "month": "2023-03-01",
          "value": 4017451910
        },
        {
          "month": "2023-04-01",
          "value": 3833597850
        },
        {
          "month": "2023-05-01",
          "value": 3826789025
        },
        {
          "month": "2023-06-01",
          "value": 3489984776
        },
        {
          "month": "2023-07-01",
          "value": 3540348477
        },
        {
          "month": "2023-08-01",
          "value": 3740966071
        },
        {
          "month": "2023-09-01",
          "value": 3667746477
        },
        {
          "month": "2023-10-01",
          "value": 3648975662
        },
        {
          "month": "2023-11-01",
          "value": 3405521986
        },
        {
          "month": "2023-12-01",
          "value": 3176377118
        },
        {
          "month": "2024-01-01",
          "value": 3686483354
        },
        {
          "month": "2024-02-01",
          "value": 3189497481
        },
        {
          "month": "2024-03-01",
          "value": 3434133213
        },
        {
          "month": "2024-04-01",
          "value": 3251883499
        },
        {
          "month": "2024-05-01",
          "value": 3300344129
        },
        {
          "month": "2024-06-01",
          "value": 3043365002
        },
        {
          "month": "2024-07-01",
          "value": 3020692222
        },
        {
          "month": "2024-08-01",
          "value": 3353738917
        },
        {
          "month": "2024-09-01",
          "value": 3523195190
        },
        {
          "month": "2024-10-01",
          "value": 3569734048
        },
        {
          "month": "2024-11-01",
          "value": 3466745247
        },
        {
          "month": "2024-12-01",
          "value": 3168067188
        },
        {
          "month": "2025-01-01",
          "value": 4042779275
        },
        {
          "month": "2025-02-01",
          "value": 3629491020
        },
        {
          "month": "2025-03-01",
          "value": 4059689964
        },
        {
          "month": "2025-04-01",
          "value": 3730255629
        },
        {
          "month": "2025-05-01",
          "value": 3843492784
        },
        {
          "month": "2025-06-01",
          "value": 3417350620
        },
        {
          "month": "2025-07-01",
          "value": 3423307148
        },
        {
          "month": "2025-08-01",
          "value": 3620201759
        },
        {
          "month": "2025-09-01",
          "value": 3642679642
        },
        {
          "month": "2025-10-01",
          "value": 3696823899
        },
        {
          "month": "2025-11-01",
          "value": 2031994464
        },
        {
          "month": "2025-12-01",
          "value": 1273587830
        }
      ]
    },
    {
      "category": "dach-marken",
      "series": [
        {
          "month": "2021-11-01",
          "value": 7891628195
        },
        {
          "month": "2021-12-01",
          "value": 7700106520
        },
        {
          "month": "2022-01-01",
          "value": 8205312947
        },
        {
          "month": "2022-02-01",
          "value": 7420259607
        },
        {
          "month": "2022-03-01",
          "value": 8041565688
        },
        {
          "month": "2022-04-01",
          "value": 7281431324
        },
        {
          "month": "2022-05-01",
          "value": 7225528602
        },
        {
          "month": "2022-06-01",
          "value": 6850168568
        },
        {
          "month": "2022-07-01",
          "value": 6926238798
        },
        {
          "month": "2022-08-01",
          "value": 7146280117
        },
        {
          "month": "2022-09-01",
          "value": 7179087067
        },
        {
          "month": "2022-10-01",
          "value": 7252717267
        },
        {
          "month": "2022-11-01",
          "value": 7127010206
        },
        {
          "month": "2022-12-01",
          "value": 6566656054
        },
        {
          "month": "2023-01-01",
          "value": 7387558866
        },
        {
          "month": "2023-02-01",
          "value": 6902402500
        },
        {
          "month": "2023-03-01",
          "value": 7348988649
        },
        {
          "month": "2023-04-01",
          "value": 6869098953
        },
        {
          "month": "2023-05-01",
          "value": 7043428137
        },
        {
          "month": "2023-06-01",
          "value": 6686069330
        },
        {
          "month": "2023-07-01",
          "value": 6815614916
        },
        {
          "month": "2023-08-01",
          "value": 7145676760
        },
        {
          "month": "2023-09-01",
          "value": 6940596498
        },
        {
          "month": "2023-10-01",
          "value": 6919060572
        },
        {
          "month": "2023-11-01",
          "value": 6803124939
        },
        {
          "month": "2023-12-01",
          "value": 6395678279
        },
        {
          "month": "2024-01-01",
          "value": 6005611594
        },
        {
          "month": "2024-02-01",
          "value": 5644782129
        },
        {
          "month": "2024-03-01",
          "value": 5647890735
        },
        {
          "month": "2024-04-01",
          "value": 5346263531
        },
        {
          "month": "2024-05-01",
          "value": 5487007507
        },
        {
          "month": "2024-06-01",
          "value": 5312898318
        },
        {
          "month": "2024-07-01",
          "value": 5175870159
        },
        {
          "month": "2024-08-01",
          "value": 5536931348
        },
        {
          "month": "2024-09-01",
          "value": 5868318027
        },
        {
          "month": "2024-10-01",
          "value": 5885620851
        },
        {
          "month": "2024-11-01",
          "value": 5335816385
        },
        {
          "month": "2024-12-01",
          "value": 5443982147
        },
        {
          "month": "2025-01-01",
          "value": 8125615287
        },
        {
          "month": "2025-02-01",
          "value": 7395836243
        },
        {
          "month": "2025-03-01",
          "value": 8057237473
        },
        {
          "month": "2025-04-01",
          "value": 7237583110
        },
        {
          "month": "2025-05-01",
          "value": 7439436305
        },
        {
          "month": "2025-06-01",
          "value": 7008011003
        },
        {
          "month": "2025-07-01",
          "value": 7179868262
        },
        {
          "month": "2025-08-01",
          "value": 7192379483
        },
        {
          "month": "2025-09-01",
          "value": 7223132556
        },
        {
          "month": "2025-10-01",
          "value": 7162778767
        },
        {
          "month": "2025-11-01",
          "value": 4665572126
        },
        {
          "month": "2025-12-01",
          "value": 4676677444
        }
      ]
    },
    {
      "category": "einzelangebot",
      "series": [
        {
          "month": "2021-11-01",
          "value": 4066492891
        },
        {
          "month": "2021-12-01",
          "value": 4012420785
        },
        {
          "month": "2022-01-01",
          "value": 4273643830
        },
        {
          "month": "2022-02-01",
          "value": 3841192037
        },
        {
          "month": "2022-03-01",
          "value": 4093131605
        },
        {
          "month": "2022-04-01",
          "value": 3722419363
        },
        {
          "month": "2022-05-01",
          "value": 3687566806
        },
        {
          "month": "2022-06-01",
          "value": 3506015159
        },
        {
          "month": "2022-07-01",
          "value": 3560291588
        },
        {
          "month": "2022-08-01",
          "value": 3669345322
        },
        {
          "month": "2022-09-01",
          "value": 3695081451
        },
        {
          "month": "2022-10-01",
          "value": 3728881195
        },
        {
          "month": "2022-11-01",
          "value": 3629833038
        },
        {
          "month": "2022-12-01",
          "value": 3360752648
        },
        {
          "month": "2023-01-01",
          "value": 3750879952
        },
        {
          "month": "2023-02-01",
          "value": 3482219254
        },
        {
          "month": "2023-03-01",
          "value": 3721107447
        },
        {
          "month": "2023-04-01",
          "value": 3484496754
        },
        {
          "month": "2023-05-01",
          "value": 3571443385
        },
        {
          "month": "2023-06-01",
          "value": 3400331946
        },
        {
          "month": "2023-07-01",
          "value": 3475833764
        },
        {
          "month": "2023-08-01",
          "value": 3613226407
        },
        {
          "month": "2023-09-01",
          "value": 3497728887
        },
        {
          "month": "2023-10-01",
          "value": 3391969015
        },
        {
          "month": "2023-11-01",
          "value": 3323909124
        },
        {
          "month": "2023-12-01",
          "value": 3131023823
        },
        {
          "month": "2024-01-01",
          "value": 2990353193
        },
        {
          "month": "2024-02-01",
          "value": 2807753578
        },
        {
          "month": "2024-03-01",
          "value": 2821350439
        },
        {
          "month": "2024-04-01",
          "value": 2659792459
        },
        {
          "month": "2024-05-01",
          "value": 2738753171
        },
        {
          "month": "2024-06-01",
          "value": 2642087933
        },
        {
          "month": "2024-07-01",
          "value": 2595491074
        },
        {
          "month": "2024-08-01",
          "value": 2764442919
        },
        {
          "month": "2024-09-01",
          "value": 2925302856
        },
        {
          "month": "2024-10-01",
          "value": 2932268455
        },
        {
          "month": "2024-11-01",
          "value": 2659379311
        },
        {
          "month": "2024-12-01",
          "value": 2718240516
        },
        {
          "month": "2025-01-01",
          "value": 3994125243
        },
        {
          "month": "2025-02-01",
          "value": 3616391942
        },
        {
          "month": "2025-03-01",
          "value": 3942173818
        },
        {
          "month": "2025-04-01",
          "value": 3564657192
        },
        {
          "month": "2025-05-01",
          "value": 3684999155
        },
        {
          "month": "2025-06-01",
          "value": 3485819362
        },
        {
          "month": "2025-07-01",
          "value": 3563414695
        },
        {
          "month": "2025-08-01",
          "value": 3535247212
        },
        {
          "month": "2025-09-01",
          "value": 3550723098
        },
        {
          "month": "2025-10-01",
          "value": 3570658964
        },
        {
          "month": "2025-11-01",
          "value": 2259682979
        },
        {
          "month": "2025-12-01",
          "value": 2271742382
        }
      ]
    }
  ],
  "top_latest": [
    {
      "name": "ORF.at Network",
      "category": "dach-marken",
      "type": "mediahouse",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 715984032
    },
    {
      "name": "GMX \u00d6sterreich Gesamt",
      "category": "dach-marken",
      "type": "mediahouse",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 608350620
    },
    {
      "name": "orf.at",
      "category": "einzelangebot",
      "type": "service",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 548577678
    },
    {
      "name": "orf.at",
      "category": "dach-marken",
      "type": "service",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 548577678
    },
    {
      "name": "gmx.at - GMX.at",
      "category": "einzelangebot",
      "type": "service",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 481555850
    },
    {
      "name": "gmx.at - GMX.at",
      "category": "dach-marken",
      "type": "service",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 481555850
    },
    {
      "name": "COPE",
      "category": "adnetwork",
      "type": "adnetwork",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 466410440
    },
    {
      "name": "krone.at Gesamtangebot",
      "category": "dach-marken",
      "type": "mediahouse",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 235863155
    },
    {
      "name": "austria.com/plus",
      "category": "adnetwork",
      "type": "adnetwork",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 205872630
    },
    {
      "name": "krone.at",
      "category": "einzelangebot",
      "type": "service",
      "unique_users": 0,
      "net_reach": "0",
      "impressions": 175767735
    }
  ],
  "scatter_latest": [
    {
      "name": "ORF.at Network",
      "category": "dach-marken",
      "usetime_seconds": 370,
      "impressions_per_visits": 5.39,
      "impressions": 715984032
    },
    {
      "name": "GMX \u00d6sterreich Gesamt",
      "category": "dach-marken",
      "usetime_seconds": 440,
      "impressions_per_visits": 6.4,
      "impressions": 608350620
    },
    {
      "name": "orf.at",
      "category": "einzelangebot",
      "usetime_seconds": 353,
      "impressions_per_visits": 4.89,
      "impressions": 548577678
    },
    {
      "name": "orf.at",
      "category": "dach-marken",
      "usetime_seconds": 353,
      "impressions_per_visits": 4.89,
      "impressions": 548577678
    },
    {
      "name": "gmx.at - GMX.at",
      "category": "einzelangebot",
      "usetime_seconds": 412,
      "impressions_per_visits": 5.37,
      "impressions": 481555850
    },
    {
      "name": "gmx.at - GMX.at",
      "category": "dach-marken",
      "usetime_seconds": 412,
      "impressions_per_visits": 5.37,
      "impressions": 481555850
    },
    {
      "name": "COPE",
      "category": "adnetwork",
      "usetime_seconds": 373,
      "impressions_per_visits": 6.99,
      "impressions": 466410440
    },
    {
      "name": "krone.at Gesamtangebot",
      "category": "dach-marken",
      "usetime_seconds": 314,
      "impressions_per_visits": 4.43,
      "impressions": 235863155
    },
    {
      "name": "austria.com/plus",
      "category": "adnetwork",
      "usetime_seconds": 232,
      "impressions_per_visits": 3.45,
      "impressions": 205872630
    },
    {
      "name": "krone.at",
      "category": "einzelangebot",
      "usetime_seconds": 296,
      "impressions_per_visits": 3.4,
      "impressions": 175767735
    },
    {
      "name": "krone.at",
      "category": "dach-marken",
      "usetime_seconds": 296,
      "impressions_per_visits": 3.4,
      "impressions": 175767735
    },
    {
      "name": "COPE Dachangebot",
      "category": "dach-marken",
      "usetime_seconds": 304,
      "impressions_per_visits": 4.77,
      "impressions": 155876755
    },
    {
      "name": "oe24-Netzwerk",
      "category": "dach-marken",
      "usetime_seconds": 174,
      "impressions_per_visits": 4.34,
      "impressions": 145218280
    },
    {
      "name": "oe24.at",
      "category": "einzelangebot",
      "usetime_seconds": 174,
      "impressions_per_visits": 4.28,
      "impressions": 138639879
    },
    {
      "name": "oe24.at",
      "category": "dach-marken",
      "usetime_seconds": 174,
      "impressions_per_visits": 4.28,
      "impressions": 138639879
    },
    {
      "name": "gmx.net - GMX.at",
      "category": "einzelangebot",
      "usetime_seconds": 412,
      "impressions_per_visits": 10.76,
      "impressions": 126794770
    },
    {
      "name": "gmx.net - GMX.at",
      "category": "dach-marken",
      "usetime_seconds": 412,
      "impressions_per_visits": 10.76,
      "impressions": 126794770
    },
    {
      "name": "Azerion Austria",
      "category": "adnetwork",
      "usetime_seconds": 259,
      "impressions_per_visits": 3.31,
      "impressions": 122988399
    },
    {
      "name": "kleinezeitung.at",
      "category": "einzelangebot",
      "usetime_seconds": 280,
      "impressions_per_visits": 5.36,
      "impressions": 105897061
    },
    {
      "name": "kleinezeitung.at",
      "category": "dach-marken",
      "usetime_seconds": 280,
      "impressions_per_visits": 5.36,
      "impressions": 105897061
    },
    {
      "name": "kleinezeitung.at",
      "category": "adnetwork",
      "usetime_seconds": 280,
      "impressions_per_visits": 5.36,
      "impressions": 105897061
    },
    {
      "name": "derStandard.at Network",
      "category": "dach-marken",
      "usetime_seconds": 382,
      "impressions_per_visits": 3.11,
      "impressions": 102699412
    },
    {
      "name": "Heute.at - Dachangebot",
      "category": "dach-marken",
      "usetime_seconds": 257,
      "impressions_per_visits": 3.47,
      "impressions": 100933683
    },
    {
      "name": "heute.at",
      "category": "einzelangebot",
      "usetime_seconds": 258,
      "impressions_per_visits": 3.48,
      "impressions": 100186003
    },
    {
      "name": "heute.at",
      "category": "dach-marken",
      "usetime_seconds": 258,
      "impressions_per_visits": 3.48,
      "impressions": 100186003
    },
    {
      "name": "heute.at",
      "category": "adnetwork",
      "usetime_seconds": 258,
      "impressions_per_visits": 3.48,
      "impressions": 100186003
    },
    {
      "name": "derstandard.at - derStandard.at",
      "category": "einzelangebot",
      "usetime_seconds": 411,
      "impressions_per_visits": 3.3,
      "impressions": 98204288
    },
    {
      "name": "derstandard.at - derStandard.at",
      "category": "dach-marken",
      "usetime_seconds": 411,
      "impressions_per_visits": 3.3,
      "impressions": 98204288
    },
    {
      "name": "RegionalMedien Austria Digital",
      "category": "dach-marken",
      "usetime_seconds": 143,
      "impressions_per_visits": 5.24,
      "impressions": 73356643
    },
    {
      "name": "MeinBezirk.at",
      "category": "einzelangebot",
      "usetime_seconds": 144,
      "impressions_per_visits": 5.36,
      "impressions": 72702494
    }
  ],
  "missing_months": [
    "2021-11-01",
    "2022-01-01",
    "2022-02-01",
    "2022-03-01",
    "2022-05-01",
    "2022-06-01",
    "2022-07-01",
    "2022-08-01",
    "2022-09-01",
    "2023-02-01",
    "2023-03-01",
    "2023-05-01",
    "2023-09-01",
    "2023-10-01",
    "2023-11-01",
    "2023-12-01",
    "2024-01-01",
    "2024-02-01",
    "2024-03-01",
    "2024-04-01",
    "2024-05-01",
    "2024-06-01",
    "2024-07-01",
    "2024-08-01",
    "2024-09-01",
    "2024-10-01",
    "2024-11-01",
    "2024-12-01",
    "2025-01-01",
    "2025-07-01",
    "2025-08-01",
    "2025-09-01",
    "2025-10-01"
  ],
  "missing_by_category": [
    {
      "category": "adnetwork",
      "series": [
        {
          "month": "2021-11-01",
          "value": 0
        },
        {
          "month": "2022-01-01",
          "value": 0
        },
        {
          "month": "2022-02-01",
          "value": 0
        },
        {
          "month": "2022-03-01",
          "value": 0
        },
        {
          "month": "2022-05-01",
          "value": 1
        },
        {
          "month": "2022-06-01",
          "value": 1
        },
        {
          "month": "2022-07-01",
          "value": 0
        },
        {
          "month": "2022-08-01",
          "value": 0
        },
        {
          "month": "2022-09-01",
          "value": 0
        },
        {
          "month": "2023-02-01",
          "value": 1
        },
        {
          "month": "2023-03-01",
          "value": 0
        },
        {
          "month": "2023-05-01",
          "value": 0
        },
        {
          "month": "2023-09-01",
          "value": 0
        },
        {
          "month": "2023-10-01",
          "value": 1
        },
        {
          "month": "2023-11-01",
          "value": 5
        },
        {
          "month": "2023-12-01",
          "value": 5
        },
        {
          "month": "2024-01-01",
          "value": 7
        },
        {
          "month": "2024-02-01",
          "value": 7
        },
        {
          "month": "2024-03-01",
          "value": 1
        },
        {
          "month": "2024-04-01",
          "value": 0
        },
        {
          "month": "2024-05-01",
          "value": 0
        },
        {
          "month": "2024-06-01",
          "value": 0
        },
        {
          "month": "2024-07-01",
          "value": 1
        },
        {
          "month": "2024-08-01",
          "value": 0
        },
        {
          "month": "2024-09-01",
          "value": 0
        },
        {
          "month": "2024-10-01",
          "value": 0
        },
        {
          "month": "2024-11-01",
          "value": 0
        },
        {
          "month": "2024-12-01",
          "value": 0
        },
        {
          "month": "2025-01-01",
          "value": 2
        },
        {
          "month": "2025-07-01",
          "value": 0
        },
        {
          "month": "2025-08-01",
          "value": 1
        },
        {
          "month": "2025-09-01",
          "value": 2
        },
        {
          "month": "2025-10-01",
          "value": 1
        }
      ]
    },
    {
      "category": "dach-marken",
      "series": [
        {
          "month": "2021-11-01",
          "value": 1
        },
        {
          "month": "2022-01-01",
          "value": 1
        },
        {
          "month": "2022-02-01",
          "value": 1
        },
        {
          "month": "2022-03-01",
          "value": 1
        },
        {
          "month": "2022-05-01",
          "value": 0
        },
        {
          "month": "2022-06-01",
          "value": 0
        },
        {
          "month": "2022-07-01",
          "value": 3
        },
        {
          "month": "2022-08-01",
          "value": 6
        },
        {
          "month": "2022-09-01",
          "value": 1
        },
        {
          "month": "2023-02-01",
          "value": 0
        },
        {
          "month": "2023-03-01",
          "value": 0
        },
        {
          "month": "2023-05-01",
          "value": 1
        },
        {
          "month": "2023-09-01",
          "value": 14
        },
        {
          "month": "2023-10-01",
          "value": 5
        },
        {
          "month": "2023-11-01",
          "value": 6
        },
        {
          "month": "2023-12-01",
          "value": 5
        },
        {
          "month": "2024-01-01",
          "value": 21
        },
        {
          "month": "2024-02-01",
          "value": 7
        },
        {
          "month": "2024-03-01",
          "value": 9
        },
        {
          "month": "2024-04-01",
          "value": 9
        },
        {
          "month": "2024-05-01",
          "value": 5
        },
        {
          "month": "2024-06-01",
          "value": 3
        },
        {
          "month": "2024-07-01",
          "value": 4
        },
        {
          "month": "2024-08-01",
          "value": 3
        },
        {
          "month": "2024-09-01",
          "value": 3
        },
        {
          "month": "2024-10-01",
          "value": 2
        },
        {
          "month": "2024-11-01",
          "value": 5
        },
        {
          "month": "2024-12-01",
          "value": 2
        },
        {
          "month": "2025-01-01",
          "value": 2
        },
        {
          "month": "2025-07-01",
          "value": 0
        },
        {
          "month": "2025-08-01",
          "value": 0
        },
        {
          "month": "2025-09-01",
          "value": 0
        },
        {
          "month": "2025-10-01",
          "value": 2
        }
      ]
    },
    {
      "category": "einzelangebot",
      "series": [
        {
          "month": "2021-11-01",
          "value": 1
        },
        {
          "month": "2022-01-01",
          "value": 2
        },
        {
          "month": "2022-02-01",
          "value": 2
        },
        {
          "month": "2022-03-01",
          "value": 1
        },
        {
          "month": "2022-05-01",
          "value": 1
        },
        {
          "month": "2022-06-01",
          "value": 1
        },
        {
          "month": "2022-07-01",
          "value": 2
        },
        {
          "month": "2022-08-01",
          "value": 4
        },
        {
          "month": "2022-09-01",
          "value": 1
        },
        {
          "month": "2023-02-01",
          "value": 2
        },
        {
          "month": "2023-03-01",
          "value": 1
        },
        {
          "month": "2023-05-01",
          "value": 1
        },
        {
          "month": "2023-09-01",
          "value": 13
        },
        {
          "month": "2023-10-01",
          "value": 4
        },
        {
          "month": "2023-11-01",
          "value": 6
        },
        {
          "month": "2023-12-01",
          "value": 5
        },
        {
          "month": "2024-01-01",
          "value": 21
        },
        {
          "month": "2024-02-01",
          "value": 10
        },
        {
          "month": "2024-03-01",
          "value": 9
        },
        {
          "month": "2024-04-01",
          "value": 9
        },
        {
          "month": "2024-05-01",
          "value": 4
        },
        {
          "month": "2024-06-01",
          "value": 3
        },
        {
          "month": "2024-07-01",
          "value": 3
        },
        {
          "month": "2024-08-01",
          "value": 3
        },
        {
          "month": "2024-09-01",
          "value": 4
        },
        {
          "month": "2024-10-01",
          "value": 2
        },
        {
          "month": "2024-11-01",
          "value": 4
        },
        {
          "month": "2024-12-01",
          "value": 2
        },
        {
          "month": "2025-01-01",
          "value": 2
        },
        {
          "month": "2025-07-01",
          "value": 1
        },
        {
          "month": "2025-08-01",
          "value": 2
        },
        {
          "month": "2025-09-01",
          "value": 2
        },
        {
          "month": "2025-10-01",
          "value": 2
        }
      ]
    }
  ]
};

  const colors = ["#0f766e", "#0c4a6e", "#a16207", "#a21caf", "#15803d"];
  const tooltip = document.getElementById("tooltip");

  function formatNumber(value) {
    if (value === null || value === undefined) return "-";
    if (value >= 1_000_000) return (value / 1_000_000).toFixed(1) + "M";
    if (value >= 1_000) return (value / 1_000).toFixed(1) + "k";
    return value.toString();
  }

  function showTip(text, x, y) {
    tooltip.textContent = text;
    tooltip.style.left = x + "px";
    tooltip.style.top = y + "px";
    tooltip.style.opacity = "1";
  }

  function hideTip() {
    tooltip.style.opacity = "0";
  }

  function renderKpis() {
    const kpis = document.getElementById("kpis");
    const latest = data.latest_month;
    const totals = data.category_series.map(cat => {
      const last = cat.series[cat.series.length - 1];
      return { category: cat.category, value: last ? last.value : 0 };
    });

    const totalAll = totals.reduce((sum, c) => sum + c.value, 0);

    const blocks = [
      { label: "Latest Month", value: latest },
      { label: "Total Impressions", value: formatNumber(totalAll) },
      { label: "Categories", value: data.category_series.length },
      { label: "Top Brand", value: data.top_latest[0] ? data.top_latest[0].name : "-" },
    ];

    kpis.innerHTML = blocks.map(b => `
      <div class="card">
        <div class="kpi-label">${b.label}</div>
        <div class="kpi-value">${b.value}</div>
      </div>
    `).join("");
  }

  function renderLineChart() {
    const svg = document.getElementById("chart-category");
    const w = 600, h = 260, pad = 36;
    const maxY = Math.max(...data.category_series.flatMap(c => c.series.map(s => s.value)));

    let paths = "";
    let legend = "";
    let pointsMarkup = "";

    data.category_series.forEach((cat, idx) => {
      const color = colors[idx % colors.length];
      const points = cat.series.map((s, i) => {
        const x = pad + (i / (cat.series.length - 1)) * (w - pad * 2);
        const y = h - pad - (s.value / maxY) * (h - pad * 2);
        pointsMarkup += `<circle class="pop" cx="${x}" cy="${y}" r="4" fill="${color}" data-tip="${cat.category} • ${s.month} • ${formatNumber(s.value)} impressions" />`;
        return `${x},${y}`;
      }).join(" ");
      paths += `<polyline class="draw" fill="none" stroke="${color}" stroke-width="2.5" points="${points}" />`;
      legend += `<span><i class="dot" style="background:${color}"></i>${cat.category}</span>`;
    });

    const axes = `
      <line x1="${pad}" y1="${pad}" x2="${pad}" y2="${h - pad}" stroke="#cbd5e1" />
      <line x1="${pad}" y1="${h - pad}" x2="${w - pad}" y2="${h - pad}" stroke="#cbd5e1" />
    `;

    svg.innerHTML = axes + paths + pointsMarkup;
    document.getElementById("legend-category").innerHTML = legend;

    svg.querySelectorAll("circle").forEach(c => {
      c.addEventListener("mousemove", (e) => showTip(c.dataset.tip, e.clientX, e.clientY));
      c.addEventListener("mouseleave", hideTip);
    });
  }

  function renderTopList() {
    const list = document.getElementById("top-list");
    list.innerHTML = data.top_latest.map((r, idx) => `
      <li>
        <span>${idx + 1}. ${r.name}</span>
        <span>
          <span class="pill">${r.category}</span>
          <strong>${formatNumber(r.impressions)}</strong>
        </span>
      </li>
    `).join("");
  }

  function renderScatter() {
    const svg = document.getElementById("chart-scatter");
    const w = 600, h = 260, pad = 36;
    const xs = data.scatter_latest.map(d => d.impressions_per_visits);
    const ys = data.scatter_latest.map(d => d.usetime_seconds);
    const maxX = Math.max(...xs, 1);
    const maxY = Math.max(...ys, 1);

    const dots = data.scatter_latest.map((d, i) => {
      const x = pad + (d.impressions_per_visits / maxX) * (w - pad * 2);
      const y = h - pad - (d.usetime_seconds / maxY) * (h - pad * 2);
      const size = 4 + (d.impressions / xs.length) % 6;
      const color = colors[i % colors.length];
      const tip = `${d.name} • ${d.category} • ${d.impressions_per_visits.toFixed(2)} pages/visit • ${d.usetime_seconds}s`;
      return `<circle class="pop" cx="${x}" cy="${y}" r="${size}" fill="${color}" opacity="0.8" data-tip="${tip}"></circle>`;
    }).join("");

    const axes = `
      <line x1="${pad}" y1="${pad}" x2="${pad}" y2="${h - pad}" stroke="#cbd5e1" />
      <line x1="${pad}" y1="${h - pad}" x2="${w - pad}" y2="${h - pad}" stroke="#cbd5e1" />
    `;

    svg.innerHTML = axes + dots;

    svg.querySelectorAll("circle").forEach(c => {
      c.addEventListener("mousemove", (e) => showTip(c.dataset.tip, e.clientX, e.clientY));
      c.addEventListener("mouseleave", hideTip);
    });
  }

  function renderMissing() {
    const svg = document.getElementById("chart-missing");
    const w = 600, h = 260, pad = 36;
    const cats = data.missing_by_category;
    const months = data.missing_months;
    const maxY = Math.max(...cats.flatMap(c => c.series.map(s => s.value)), 1);

    const barWidth = (w - pad * 2) / months.length;
    let bars = "";

    cats.forEach((cat, cidx) => {
      const color = colors[cidx % colors.length];
      cat.series.forEach((s, i) => {
        const x = pad + i * barWidth + cidx * (barWidth / cats.length);
        const height = (s.value / maxY) * (h - pad * 2);
        const y = h - pad - height;
        const width = (barWidth / cats.length) - 2;
        const tip = `${cat.category} • ${s.month} • ${s.value} missing`;
        bars += `<rect class="bar" x="${x}" y="${y}" width="${width}" height="${height}" fill="${color}" opacity="0.75" data-tip="${tip}"></rect>`;
      });
    });

    const axes = `
      <line x1="${pad}" y1="${pad}" x2="${pad}" y2="${h - pad}" stroke="#cbd5e1" />
      <line x1="${pad}" y1="${h - pad}" x2="${w - pad}" y2="${h - pad}" stroke="#cbd5e1" />
    `;

    svg.innerHTML = axes + bars;

    const legend = cats.map((cat, idx) => `
      <span><i class="dot" style="background:${colors[idx % colors.length]}"></i>${cat.category}</span>
    `).join("");
    document.getElementById("legend-missing").innerHTML = legend;

    svg.querySelectorAll("rect").forEach(r => {
      r.addEventListener("mousemove", (e) => showTip(r.dataset.tip, e.clientX, e.clientY));
      r.addEventListener("mouseleave", hideTip);
    });
  }

  renderKpis();
  renderLineChart();
  renderTopList();
  renderScatter();
  renderMissing();

  const toggle = document.getElementById("desc-toggle");
  const panel = document.getElementById("desc-panel");
  toggle.addEventListener("click", () => {
    const isOpen = panel.classList.toggle("open");
    toggle.setAttribute("aria-expanded", isOpen ? "true" : "false");
    toggle.textContent = isOpen ? "Hide data description" : "Show data description";
  });
  </script>
</body>
</html>
